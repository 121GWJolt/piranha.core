!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.signalR=e():t.signalR=e()}(window,function(){return function(n){var r={};function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}return o.m=n,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,n){"use strict";n.r(e);n(1);var r=n(3);n.d(e,"VERSION",function(){return r.VERSION}),n.d(e,"AbortError",function(){return r.AbortError}),n.d(e,"HttpError",function(){return r.HttpError}),n.d(e,"TimeoutError",function(){return r.TimeoutError}),n.d(e,"HttpClient",function(){return r.HttpClient}),n.d(e,"HttpResponse",function(){return r.HttpResponse}),n.d(e,"DefaultHttpClient",function(){return r.DefaultHttpClient}),n.d(e,"HubConnection",function(){return r.HubConnection}),n.d(e,"HubConnectionState",function(){return r.HubConnectionState}),n.d(e,"HubConnectionBuilder",function(){return r.HubConnectionBuilder}),n.d(e,"MessageType",function(){return r.MessageType}),n.d(e,"LogLevel",function(){return r.LogLevel}),n.d(e,"HttpTransportType",function(){return r.HttpTransportType}),n.d(e,"TransferFormat",function(){return r.TransferFormat}),n.d(e,"NullLogger",function(){return r.NullLogger}),n.d(e,"JsonHubProtocol",function(){return r.JsonHubProtocol}),Uint8Array.prototype.indexOf||Object.defineProperty(Uint8Array.prototype,"indexOf",{value:Array.prototype.indexOf,writable:!0}),Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice,writable:!0}),Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,"forEach",{value:Array.prototype.forEach,writable:!0})},function(t,e,J){(function(B){t.exports=function(){"use strict";function u(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,e=void 0,o=void 0,a=function(t,e){h[r]=t,h[r+1]=e,2===(r+=2)&&(o?o(f):b())},t="undefined"!=typeof window?window:void 0,i=t||{},s=i.MutationObserver||i.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var t=setTimeout;return function(){return t(f,1)}}var h=new Array(1e3);function f(){for(var t=0;t<r;t+=2){var e=h[t],n=h[t+1];e(n),h[t]=void 0,h[t+1]=void 0}r=0}var g,d,v,y,b=void 0;function m(t,e){var n=this,r=new this.constructor(S);void 0===r[T]&&q(r);var o=n._state;if(o){var i=arguments[o-1];a(function(){return D(o,r,i,n._result)})}else O(n,r,t,e);return r}function w(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(S);return I(e,t),e}b=c?function(){return process.nextTick(f)}:s?(d=0,v=new s(f),y=document.createTextNode(""),v.observe(y,{characterData:!0}),function(){y.data=d=++d%2}):l?((g=new MessageChannel).port1.onmessage=f,function(){return g.port2.postMessage(0)}):void 0===t?function(){try{var t=J(!function(){var t=new Error("Cannot find module 'vertx'");throw t.code="MODULE_NOT_FOUND",t}());return void 0===(e=t.runOnLoop||t.runOnContext)?p():function(){e(f)}}catch(t){return p()}}():p();var T=Math.random().toString(36).substring(16);function S(){}var L=void 0,C=1,k=2,E=new R;function P(t){try{return t.then}catch(t){return E.error=t,E}}function H(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function _(t,e,n){var r,o,i,s;e.constructor===t.constructor&&n===m&&e.constructor.resolve===w?(i=t,(s=e)._state===C?M(i,s._result):s._state===k?x(i,s._result):O(s,void 0,function(t){return I(i,t)},function(t){return x(i,t)})):n===E?(x(t,E.error),E.error=null):void 0===n?M(t,e):u(n)?(r=e,o=n,a(function(e){var n=!1,t=H(o,r,function(t){n||(n=!0,r!==t?I(e,t):M(e,t))},function(t){n||(n=!0,x(e,t))},e._label);!n&&t&&(n=!0,x(e,t))},t)):M(t,e)}function I(t,e){var n,r;t===e?x(t,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=e),null===n||"object"!==r&&"function"!==r?M(t,e):_(t,e,P(e)))}function A(t){t._onerror&&t._onerror(t._result),j(t)}function M(t,e){t._state===L&&(t._result=e,t._state=C,0!==t._subscribers.length&&a(j,t))}function x(t,e){t._state===L&&(t._state=k,t._result=e,a(A,t))}function O(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+C]=n,o[i+k]=r,0===i&&t._state&&a(j,t)}function j(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?D(n,r,o,i):o(i);t._subscribers.length=0}}function R(){this.error=null}var F=new R;function D(t,e,n,r){var o=u(n),i=void 0,s=void 0,a=void 0,c=void 0;if(o){if((i=function(t,e){try{return t(e)}catch(t){return F.error=t,F}}(n,r))===F?(c=!0,s=i.error,i.error=null):a=!0,e===i)return void x(e,new TypeError("A promises callback cannot return that same promise."))}else i=r,a=!0;e._state!==L||(o&&a?I(e,i):c?x(e,s):t===C?M(e,i):t===k&&x(e,i))}var N=0;function q(t){t[T]=N++,t._state=void 0,t._result=void 0,t._subscribers=[]}var W=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(S),this.promise[T]||q(this.promise),n(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&M(this.promise,this._result))):x(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===L&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===w){var o=P(e);if(o===m&&e._state!==L)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===U){var i=new n(S);_(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===L&&(this._remaining--,t===k?x(r,n):this._result[e]=n),0===this._remaining&&M(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;O(t,void 0,function(t){return n._settledAt(C,e,t)},function(t){return n._settledAt(k,e,t)})},t}(),U=function(){function e(t){this[T]=N++,this._result=this._state=void 0,this._subscribers=[],S!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){I(e,t)},function(t){x(e,t)})}catch(t){x(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})})},e}();return U.prototype.then=m,U.all=function(t){return new W(this,t).promise},U.race=function(o){var i=this;return n(o)?new i(function(t,e){for(var n=o.length,r=0;r<n;r++)i.resolve(o[r]).then(t,e)}):new i(function(t,e){return e(new TypeError("You must pass an array to race."))})},U.resolve=w,U.reject=function(t){var e=new this(S);return x(e,t),e},U._setScheduler=function(t){o=t},U._setAsap=function(t){a=t},U._asap=a,U.polyfill=function(){var t=void 0;if(void 0!==B)t=B;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=U},(U.Promise=U).polyfill(),U}()}).call(this,J(2))},function(Bd,Cd){var Dd;Dd=function(){return this}();try{Dd=Dd||Function("return this")()||eval("this")}catch(t){"object"==typeof window&&(Dd=window)}Bd.exports=Dd},function(t,e,n){"use strict";n.r(e),n.d(e,"VERSION",function(){return f});var r=n(4);n.d(e,"AbortError",function(){return r.AbortError}),n.d(e,"HttpError",function(){return r.HttpError}),n.d(e,"TimeoutError",function(){return r.TimeoutError});var o=n(5);n.d(e,"HttpClient",function(){return o.HttpClient}),n.d(e,"HttpResponse",function(){return o.HttpResponse});var i=n(6);n.d(e,"DefaultHttpClient",function(){return i.DefaultHttpClient});var s=n(9);n.d(e,"HubConnection",function(){return s.HubConnection}),n.d(e,"HubConnectionState",function(){return s.HubConnectionState});var a=n(15);n.d(e,"HubConnectionBuilder",function(){return a.HubConnectionBuilder});var c=n(14);n.d(e,"MessageType",function(){return c.MessageType});var u=n(8);n.d(e,"LogLevel",function(){return u.LogLevel});var l=n(17);n.d(e,"HttpTransportType",function(){return l.HttpTransportType}),n.d(e,"TransferFormat",function(){return l.TransferFormat});var p=n(13);n.d(e,"NullLogger",function(){return p.NullLogger});var h=n(22);n.d(e,"JsonHubProtocol",function(){return h.JsonHubProtocol});var f="1.1.0"},function(t,e,n){"use strict";n.r(e),n.d(e,"HttpError",function(){return o}),n.d(e,"TimeoutError",function(){return s}),n.d(e,"AbortError",function(){return a});var r,i=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=function(o){function t(t,e){var n=this,r=this.constructor.prototype;return(n=o.call(this,t)||this).statusCode=e,n.__proto__=r,n}return i(t,o),t}(Error),s=function(r){function t(t){void 0===t&&(t="A timeout occurred.");var e=this,n=this.constructor.prototype;return(e=r.call(this,t)||this).__proto__=n,e}return i(t,r),t}(Error),a=function(r){function t(t){void 0===t&&(t="An abort occurred.");var e=this,n=this.constructor.prototype;return(e=r.call(this,t)||this).__proto__=n,e}return i(t,r),t}(Error)},function(t,e,n){"use strict";n.r(e),n.d(e,"HttpResponse",function(){return o}),n.d(e,"HttpClient",function(){return i});var r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=function(t,e,n){this.statusCode=t,this.statusText=e,this.content=n},i=function(){function t(){}return t.prototype.get=function(t,e){return this.send(r({},e,{method:"GET",url:t}))},t.prototype.post=function(t,e){return this.send(r({},e,{method:"POST",url:t}))},t.prototype.delete=function(t,e){return this.send(r({},e,{method:"DELETE",url:t}))},t.prototype.getCookieString=function(t){return""},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"DefaultHttpClient",function(){return l});var r,o,i=n(4),s=n(5),a=n(7),c=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});if("undefined"==typeof XMLHttpRequest){var u=require;o=u("./NodeHttpClient")}var l=function(n){function t(t){var e=n.call(this)||this;if("undefined"!=typeof XMLHttpRequest)e.httpClient=new a.XhrHttpClient(t);else{if(void 0===o)throw new Error("No HttpClient could be created.");e.httpClient=new o.NodeHttpClient(t)}return e}return c(t,n),t.prototype.send=function(t){return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new i.AbortError):t.method?t.url?this.httpClient.send(t):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t.prototype.getCookieString=function(t){return this.httpClient.getCookieString(t)},t}(s.HttpClient)},function(t,e,n){"use strict";n.r(e),n.d(e,"XhrHttpClient",function(){return i});var r,s=n(4),a=n(5),c=n(8),o=(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=function(n){function t(t){var e=n.call(this)||this;return e.logger=t,e}return o(t,n),t.prototype.send=function(o){var i=this;return o.abortSignal&&o.abortSignal.aborted?Promise.reject(new s.AbortError):o.method?o.url?new Promise(function(t,e){var n=new XMLHttpRequest;n.open(o.method,o.url,!0),n.withCredentials=!0,n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var r=o.headers;r&&Object.keys(r).forEach(function(t){n.setRequestHeader(t,r[t])}),o.responseType&&(n.responseType=o.responseType),o.abortSignal&&(o.abortSignal.onabort=function(){n.abort(),e(new s.AbortError)}),o.timeout&&(n.timeout=o.timeout),n.onload=function(){o.abortSignal&&(o.abortSignal.onabort=null),200<=n.status&&n.status<300?t(new a.HttpResponse(n.status,n.statusText,n.response||n.responseText)):e(new s.HttpError(n.statusText,n.status))},n.onerror=function(){i.logger.log(c.LogLevel.Warning,"Error from HTTP request. "+n.status+": "+n.statusText+"."),e(new s.HttpError(n.statusText,n.status))},n.ontimeout=function(){i.logger.log(c.LogLevel.Warning,"Timeout from HTTP request."),e(new s.TimeoutError)},n.send(o.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t}(a.HttpClient)},function(t,e,n){"use strict";var r,o;n.r(e),n.d(e,"LogLevel",function(){return r}),(o=r||(r={}))[o.Trace=0]="Trace",o[o.Debug=1]="Debug",o[o.Information=2]="Information",o[o.Warning=3]="Warning",o[o.Error=4]="Error",o[o.Critical=5]="Critical",o[o.None=6]="None"},function(t,e,n){"use strict";n.r(e),n.d(e,"HubConnectionState",function(){return o}),n.d(e,"HubConnection",function(){return p});var o,r,i=n(10),a=n(14),s=n(8),c=n(12),u=function(i,s,a,c){return new(a||(a=Promise))(function(t,e){function n(t){try{o(c.next(t))}catch(t){e(t)}}function r(t){try{o(c.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,r)}o((c=c.apply(i,s||[])).next())})},l=function(n,r){var o,i,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=2&e[0]?i.return:e[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,i=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],i=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}};(r=o||(o={}))[r.Disconnected=0]="Disconnected",r[r.Connected=1]="Connected";var p=function(){function r(t,e,n){var r=this;c.Arg.isRequired(t,"connection"),c.Arg.isRequired(e,"logger"),c.Arg.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this.logger=e,this.protocol=n,this.connection=t,this.handshakeProtocol=new i.HandshakeProtocol,this.connection.onreceive=function(t){return r.processIncomingData(t)},this.connection.onclose=function(t){return r.connectionClosed(t)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.id=0,this.receivedHandshakeResponse=!1,this.connectionState=o.Disconnected,this.cachedPingMessage=this.protocol.writeMessage({type:a.MessageType.Ping})}return r.create=function(t,e,n){return new r(t,e,n)},Object.defineProperty(r.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),r.prototype.start=function(){return u(this,void 0,void 0,function(){var e,n,r=this;return l(this,function(t){switch(t.label){case 0:return e={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(s.LogLevel.Debug,"Starting HubConnection."),this.receivedHandshakeResponse=!1,n=new Promise(function(t,e){r.handshakeResolver=t,r.handshakeRejecter=e}),[4,this.connection.start(this.protocol.transferFormat)];case 1:return t.sent(),this.logger.log(s.LogLevel.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(e))];case 2:return t.sent(),this.logger.log(s.LogLevel.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,n];case 3:return t.sent(),this.connectionState=o.Connected,[2]}})})},r.prototype.stop=function(){return this.logger.log(s.LogLevel.Debug,"Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),this.connection.stop()},r.prototype.stream=function(t){for(var n=this,e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var o=this.createStreamInvocation(t,e),i=new c.Subject(function(){var t=n.createCancelInvocation(o.invocationId),e=n.protocol.writeMessage(t);return delete n.callbacks[o.invocationId],n.sendMessage(e)});this.callbacks[o.invocationId]=function(t,e){e?i.error(e):t&&(t.type===a.MessageType.Completion?t.error?i.error(new Error(t.error)):i.complete():i.next(t.item))};var s=this.protocol.writeMessage(o);return this.sendMessage(s).catch(function(t){i.error(t),delete n.callbacks[o.invocationId]}),i},r.prototype.sendMessage=function(t){return this.resetKeepAliveInterval(),this.connection.send(t)},r.prototype.send=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.createInvocation(t,e,!0),o=this.protocol.writeMessage(r);return this.sendMessage(o)},r.prototype.invoke=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.createInvocation(t,n,!1);return new Promise(function(n,r){e.callbacks[o.invocationId]=function(t,e){e?r(e):t&&(t.type===a.MessageType.Completion?t.error?r(new Error(t.error)):n(t.result):r(new Error("Unexpected message type: "+t.type)))};var t=e.protocol.writeMessage(o);e.sendMessage(t).catch(function(t){r(t),delete e.callbacks[o.invocationId]})})},r.prototype.on=function(t,e){t&&e&&(t=t.toLowerCase(),this.methods[t]||(this.methods[t]=[]),-1===this.methods[t].indexOf(e)&&this.methods[t].push(e))},r.prototype.off=function(t,e){if(t){t=t.toLowerCase();var n=this.methods[t];if(n)if(e){var r=n.indexOf(e);-1!==r&&(n.splice(r,1),0===n.length&&delete this.methods[t])}else delete this.methods[t]}},r.prototype.onclose=function(t){t&&this.closedCallbacks.push(t)},r.prototype.processIncomingData=function(t){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(t=this.processHandshakeResponse(t),this.receivedHandshakeResponse=!0),t)for(var e=0,n=this.protocol.parseMessages(t,this.logger);e<n.length;e++){var r=n[e];switch(r.type){case a.MessageType.Invocation:this.invokeClientMethod(r);break;case a.MessageType.StreamItem:case a.MessageType.Completion:var o=this.callbacks[r.invocationId];null!=o&&(r.type===a.MessageType.Completion&&delete this.callbacks[r.invocationId],o(r));break;case a.MessageType.Ping:break;case a.MessageType.Close:this.logger.log(s.LogLevel.Information,"Close message received from server."),this.connection.stop(r.error?new Error("Server returned an error on close: "+r.error):void 0);break;default:this.logger.log(s.LogLevel.Warning,"Invalid message type: "+r.type+".")}}this.resetTimeoutPeriod()},r.prototype.processHandshakeResponse=function(t){var e,n,r;try{r=(e=this.handshakeProtocol.parseHandshakeResponse(t))[0],n=e[1]}catch(t){var o="Error parsing handshake response: "+t;this.logger.log(s.LogLevel.Error,o);var i=new Error(o);throw this.connection.stop(i),this.handshakeRejecter(i),i}if(n.error){o="Server returned handshake error: "+n.error;throw this.logger.log(s.LogLevel.Error,o),this.handshakeRejecter(o),this.connection.stop(new Error(o)),new Error(o)}return this.logger.log(s.LogLevel.Debug,"Server handshake complete."),this.handshakeResolver(),r},r.prototype.resetKeepAliveInterval=function(){var t=this;this.cleanupPingTimer(),this.pingServerHandle=setTimeout(function(){return u(t,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:if(this.connectionState!==o.Connected)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return t.sent(),[3,4];case 3:return t.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}})})},this.keepAliveIntervalInMilliseconds)},r.prototype.resetTimeoutPeriod=function(){var t=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout(function(){return t.serverTimeout()},this.serverTimeoutInMilliseconds))},r.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},r.prototype.invokeClientMethod=function(e){var n=this,t=this.methods[e.target.toLowerCase()];if(t){if(t.forEach(function(t){return t.apply(n,e.arguments)}),e.invocationId){var r="Server requested a response, which is not supported in this version of the client.";this.logger.log(s.LogLevel.Error,r),this.connection.stop(new Error(r))}}else this.logger.log(s.LogLevel.Warning,"No client method with the name '"+e.target+"' found.")},r.prototype.connectionClosed=function(e){var n=this,r=this.callbacks;this.callbacks={},this.connectionState=o.Disconnected,this.handshakeRejecter&&this.handshakeRejecter(e),Object.keys(r).forEach(function(t){(0,r[t])(null,e||new Error("Invocation canceled due to connection being closed."))}),this.cleanupTimeout(),this.cleanupPingTimer(),this.closedCallbacks.forEach(function(t){return t.apply(n,[e])})},r.prototype.cleanupPingTimer=function(){this.pingServerHandle&&clearTimeout(this.pingServerHandle)},r.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},r.prototype.createInvocation=function(t,e,n){if(n)return{arguments:e,target:t,type:a.MessageType.Invocation};var r=this.id;return this.id++,{arguments:e,invocationId:r.toString(),target:t,type:a.MessageType.Invocation}},r.prototype.createStreamInvocation=function(t,e){var n=this.id;return this.id++,{arguments:e,invocationId:n.toString(),target:t,type:a.MessageType.StreamInvocation}},r.prototype.createCancelInvocation=function(t){return{invocationId:t,type:a.MessageType.CancelInvocation}},r}()},function(t,e,n){"use strict";n.r(e),n.d(e,"HandshakeProtocol",function(){return r});var u=n(11),l=n(12),r=function(){function t(){}return t.prototype.writeHandshakeRequest=function(t){return u.TextMessageFormat.write(JSON.stringify(t))},t.prototype.parseHandshakeResponse=function(t){var e,n;if(Object(l.isArrayBuffer)(t)||"undefined"!=typeof Buffer&&t instanceof Buffer){var r=new Uint8Array(t);if(-1===(i=r.indexOf(u.TextMessageFormat.RecordSeparatorCode)))throw new Error("Message is incomplete.");var o=i+1;e=String.fromCharCode.apply(null,r.slice(0,o)),n=r.byteLength>o?r.slice(o).buffer:null}else{var i,s=t;if(-1===(i=s.indexOf(u.TextMessageFormat.RecordSeparator)))throw new Error("Message is incomplete.");o=i+1;e=s.substring(0,o),n=s.length>o?s.substring(o):null}var a=u.TextMessageFormat.parse(e),c=JSON.parse(a[0]);if(c.type)throw new Error("Expected a handshake response from the server.");return[n,c]},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"TextMessageFormat",function(){return r});var r=function(){function n(){}return n.write=function(t){return""+t+n.RecordSeparator},n.parse=function(t){if(t[t.length-1]!==n.RecordSeparator)throw new Error("Message is incomplete.");var e=t.split(n.RecordSeparator);return e.pop(),e},n.RecordSeparatorCode=30,n.RecordSeparator=String.fromCharCode(n.RecordSeparatorCode),n}()},function(t,e,n){"use strict";n.r(e),n.d(e,"Arg",function(){return i}),n.d(e,"getDataDetail",function(){return d}),n.d(e,"formatArrayBuffer",function(){return s}),n.d(e,"isArrayBuffer",function(){return v}),n.d(e,"sendMessage",function(){return a}),n.d(e,"createLogger",function(){return c}),n.d(e,"Subject",function(){return u}),n.d(e,"SubjectSubscription",function(){return l}),n.d(e,"ConsoleLogger",function(){return p});var f=n(8),r=n(13),o=function(i,s,a,c){return new(a||(a=Promise))(function(t,e){function n(t){try{o(c.next(t))}catch(t){e(t)}}function r(t){try{o(c.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,r)}o((c=c.apply(i,s||[])).next())})},g=function(n,r){var o,i,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=2&e[0]?i.return:e[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,i=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],i=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},i=function(){function t(){}return t.isRequired=function(t,e){if(null==t)throw new Error("The '"+e+"' argument is required.")},t.isIn=function(t,e,n){if(!(t in e))throw new Error("Unknown "+n+" value: "+t+".")},t}();function d(t,e){var n="";return v(t)?(n="Binary data of length "+t.byteLength,e&&(n+=". Content: '"+s(t)+"'")):"string"==typeof t&&(n="String data of length "+t.length,e&&(n+=". Content: '"+t+"'")),n}function s(t){var e=new Uint8Array(t),n="";return e.forEach(function(t){n+="0x"+(t<16?"0":"")+t.toString(16)+" "}),n.substr(0,n.length-1)}function v(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function a(s,a,c,u,l,p,h){return o(this,void 0,void 0,function(){var e,n,r,o,i;return g(this,function(t){switch(t.label){case 0:return l?[4,l()]:[3,2];case 1:(r=t.sent())&&((e={}).Authorization="Bearer "+r,n=e),t.label=2;case 2:return s.log(f.LogLevel.Trace,"("+a+" transport) sending data. "+d(p,h)+"."),o=v(p)?"arraybuffer":"text",[4,c.post(u,{content:p,headers:n,responseType:o})];case 3:return i=t.sent(),s.log(f.LogLevel.Trace,"("+a+" transport) request complete. Response status: "+i.statusCode+"."),[2]}})})}function c(t){return void 0===t?new p(f.LogLevel.Information):null===t?r.NullLogger.instance:t.log?t:new p(t)}var u=function(){function t(t){this.observers=[],this.cancelCallback=t}return t.prototype.next=function(t){for(var e=0,n=this.observers;e<n.length;e++){n[e].next(t)}},t.prototype.error=function(t){for(var e=0,n=this.observers;e<n.length;e++){var r=n[e];r.error&&r.error(t)}},t.prototype.complete=function(){for(var t=0,e=this.observers;t<e.length;t++){var n=e[t];n.complete&&n.complete()}},t.prototype.subscribe=function(t){return this.observers.push(t),new l(this,t)},t}(),l=function(){function t(t,e){this.subject=t,this.observer=e}return t.prototype.dispose=function(){var t=this.subject.observers.indexOf(this.observer);-1<t&&this.subject.observers.splice(t,1),0===this.subject.observers.length&&this.subject.cancelCallback().catch(function(t){})},t}(),p=function(){function t(t){this.minimumLogLevel=t}return t.prototype.log=function(t,e){if(t>=this.minimumLogLevel)switch(t){case f.LogLevel.Critical:case f.LogLevel.Error:console.error("["+(new Date).toISOString()+"] "+f.LogLevel[t]+": "+e);break;case f.LogLevel.Warning:console.warn("["+(new Date).toISOString()+"] "+f.LogLevel[t]+": "+e);break;case f.LogLevel.Information:console.info("["+(new Date).toISOString()+"] "+f.LogLevel[t]+": "+e);break;default:console.log("["+(new Date).toISOString()+"] "+f.LogLevel[t]+": "+e)}},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"NullLogger",function(){return r});var r=function(){function t(){}return t.prototype.log=function(t,e){},t.instance=new t,t}()},function(t,e,n){"use strict";var r,o;n.r(e),n.d(e,"MessageType",function(){return r}),(o=r||(r={}))[o.Invocation=1]="Invocation",o[o.StreamItem=2]="StreamItem",o[o.Completion=3]="Completion",o[o.StreamInvocation=4]="StreamInvocation",o[o.CancelInvocation=5]="CancelInvocation",o[o.Ping=6]="Ping",o[o.Close=7]="Close"},function(t,e,n){"use strict";n.r(e),n.d(e,"HubConnectionBuilder",function(){return c});var r=n(16),o=n(9),i=n(22),s=n(13),a=n(12),c=function(){function t(){}return t.prototype.configureLogging=function(t){return a.Arg.isRequired(t,"logging"),void 0!==t.log?this.logger=t:this.logger=new a.ConsoleLogger(t),this},t.prototype.withUrl=function(t,e){return a.Arg.isRequired(t,"url"),this.url=t,this.httpConnectionOptions="object"==typeof e?e:{transport:e},this},t.prototype.withHubProtocol=function(t){return a.Arg.isRequired(t,"protocol"),this.protocol=t,this},t.prototype.build=function(){var t=this.httpConnectionOptions||{};if(void 0===t.logger&&(t.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var e=new r.HttpConnection(this.url,t);return o.HubConnection.create(e,this.logger||s.NullLogger.instance,this.protocol||new i.JsonHubProtocol)},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"HttpConnection",function(){return p});var r=n(6),h=n(8),f=n(17),l=n(18),o=n(20),i=n(12),s=n(21),g=function(i,s,a,c){return new(a||(a=Promise))(function(t,e){function n(t){try{o(c.next(t))}catch(t){e(t)}}function r(t){try{o(c.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,r)}o((c=c.apply(i,s||[])).next())})},d=function(n,r){var o,i,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=2&e[0]?i.return:e[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,i=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],i=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},a=null,c=null;if("undefined"==typeof window){var u=require;a=u("ws"),c=u("eventsource")}var p=function(){function t(t,e){void 0===e&&(e={}),this.features={},i.Arg.isRequired(t,"url"),this.logger=Object(i.createLogger)(e.logger),this.baseUrl=this.resolveUrl(t),(e=e||{}).logMessageContent=e.logMessageContent||!1;var n="undefined"==typeof window;n||"undefined"==typeof WebSocket||e.WebSocket?n&&!e.WebSocket&&a&&(e.WebSocket=a):e.WebSocket=WebSocket,n||"undefined"==typeof EventSource||e.EventSource?n&&!e.EventSource&&void 0!==c&&(e.EventSource=c):e.EventSource=EventSource,this.httpClient=e.httpClient||new r.DefaultHttpClient(this.logger),this.connectionState=2,this.options=e,this.onreceive=null,this.onclose=null}return t.prototype.start=function(t){return t=t||f.TransferFormat.Binary,i.Arg.isIn(t,f.TransferFormat,"transferFormat"),this.logger.log(h.LogLevel.Debug,"Starting connection with transfer format '"+f.TransferFormat[t]+"'."),2!==this.connectionState?Promise.reject(new Error("Cannot start a connection that is not in the 'Disconnected' state.")):(this.connectionState=0,this.startPromise=this.startInternal(t),this.startPromise)},t.prototype.send=function(t){if(1!==this.connectionState)throw new Error("Cannot send data if the connection is not in the 'Connected' State.");return this.transport.send(t)},t.prototype.stop=function(e){return g(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:this.connectionState=2,this.stopError=e,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startPromise];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return this.transport?[4,this.transport.stop()]:[3,6];case 5:t.sent(),this.transport=void 0,t.label=6;case 6:return[2]}})})},t.prototype.startInternal=function(u){return g(this,void 0,void 0,function(){var n,r,o,e,i,s,a,c=this;return d(this,function(t){switch(t.label){case 0:n=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,t.label=1;case 1:return t.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==f.HttpTransportType.WebSockets?[3,3]:(this.transport=this.constructTransport(f.HttpTransportType.WebSockets),[4,this.transport.connect(n,u)]):[3,5];case 2:return t.sent(),[3,4];case 3:throw Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:r=null,o=0,e=function(){var e;return d(this,function(t){switch(t.label){case 0:return[4,i.getNegotiationResponse(n)];case 1:if(r=t.sent(),2===i.connectionState)return[2,{value:void 0}];if(r.error)throw Error(r.error);if(r.ProtocolVersion)throw Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return r.url&&(n=r.url),r.accessToken&&(e=r.accessToken,i.accessTokenFactory=function(){return e}),o++,[2]}})},i=this,t.label=6;case 6:return[5,e()];case 7:if("object"==typeof(s=t.sent()))return[2,s.value];t.label=8;case 8:if(r.url&&o<100)return[3,6];t.label=9;case 9:if(100===o&&r.url)throw Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(n,this.options.transport,r,u)];case 10:t.sent(),t.label=11;case 11:return this.transport instanceof l.LongPollingTransport&&(this.features.inherentKeepAlive=!0),this.transport.onreceive=this.onreceive,this.transport.onclose=function(t){return c.stopConnection(t)},this.changeState(0,1),[3,13];case 12:throw a=t.sent(),this.logger.log(h.LogLevel.Error,"Failed to start the connection: "+a),this.connectionState=2,this.transport=void 0,a;case 13:return[2]}})})},t.prototype.getNegotiationResponse=function(a){return g(this,void 0,void 0,function(){var e,n,r,o,i,s;return d(this,function(t){switch(t.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=t.sent())&&((e={}).Authorization="Bearer "+r,n=e),t.label=2;case 2:o=this.resolveNegotiateUrl(a),this.logger.log(h.LogLevel.Debug,"Sending negotiation request: "+o+"."),t.label=3;case 3:return t.trys.push([3,5,,6]),[4,this.httpClient.post(o,{content:"",headers:n})];case 4:if(200!==(i=t.sent()).statusCode)throw Error("Unexpected status code returned from negotiate "+i.statusCode);return[2,JSON.parse(i.content)];case 5:throw s=t.sent(),this.logger.log(h.LogLevel.Error,"Failed to complete negotiation with the server: "+s),s;case 6:return[2]}})})},t.prototype.createConnectUrl=function(t,e){return e?t+(-1===t.indexOf("?")?"?":"&")+"id="+e:t},t.prototype.createTransport=function(c,u,l,p){return g(this,void 0,void 0,function(){var e,n,r,o,i,s,a;return d(this,function(t){switch(t.label){case 0:return e=this.createConnectUrl(c,l.connectionId),this.isITransport(u)?(this.logger.log(h.LogLevel.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=u,[4,this.transport.connect(e,p)]):[3,2];case 1:return t.sent(),this.changeState(0,1),[2];case 2:n=l.availableTransports||[],r=0,o=n,t.label=3;case 3:return r<o.length?(i=o[r],this.connectionState=0,"number"!=typeof(s=this.resolveTransport(i,u,p))?[3,8]:(this.transport=this.constructTransport(s),l.connectionId?[3,5]:[4,this.getNegotiationResponse(c)])):[3,9];case 4:l=t.sent(),e=this.createConnectUrl(c,l.connectionId),t.label=5;case 5:return t.trys.push([5,7,,8]),[4,this.transport.connect(e,p)];case 6:return t.sent(),this.changeState(0,1),[2];case 7:return a=t.sent(),this.logger.log(h.LogLevel.Error,"Failed to start the transport '"+f.HttpTransportType[s]+"': "+a),this.connectionState=2,l.connectionId=void 0,[3,8];case 8:return r++,[3,3];case 9:throw new Error("Unable to initialize any of the available transports.")}})})},t.prototype.constructTransport=function(t){switch(t){case f.HttpTransportType.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new s.WebSocketTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket);case f.HttpTransportType.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new o.ServerSentEventsTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource);case f.HttpTransportType.LongPolling:return new l.LongPollingTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1);default:throw new Error("Unknown transport: "+t+".")}},t.prototype.resolveTransport=function(t,e,n){var r,o,i=f.HttpTransportType[t.transport];if(null==i)this.logger.log(h.LogLevel.Debug,"Skipping transport '"+t.transport+"' because it is not supported by this client.");else{var s=t.transferFormats.map(function(t){return f.TransferFormat[t]});if(o=i,(r=e)&&0==(o&r))this.logger.log(h.LogLevel.Debug,"Skipping transport '"+f.HttpTransportType[i]+"' because it was disabled by the client.");else if(0<=s.indexOf(n)){if((i!==f.HttpTransportType.WebSockets||this.options.WebSocket)&&(i!==f.HttpTransportType.ServerSentEvents||this.options.EventSource))return this.logger.log(h.LogLevel.Debug,"Selecting transport '"+f.HttpTransportType[i]+"'."),i;this.logger.log(h.LogLevel.Debug,"Skipping transport '"+f.HttpTransportType[i]+"' because it is not supported in your environment.'")}else this.logger.log(h.LogLevel.Debug,"Skipping transport '"+f.HttpTransportType[i]+"' because it does not support the requested transfer format '"+f.TransferFormat[n]+"'.")}return null},t.prototype.isITransport=function(t){return t&&"object"==typeof t&&"connect"in t},t.prototype.changeState=function(t,e){return this.connectionState===t&&(this.connectionState=e,!0)},t.prototype.stopConnection=function(t){this.transport=void 0,(t=this.stopError||t)?this.logger.log(h.LogLevel.Error,"Connection disconnected with error '"+t+"'."):this.logger.log(h.LogLevel.Information,"Connection disconnected."),this.connectionState=2,this.onclose&&this.onclose(t)},t.prototype.resolveUrl=function(t){if(0===t.lastIndexOf("https://",0)||0===t.lastIndexOf("http://",0))return t;if("undefined"==typeof window||!window||!window.document)throw new Error("Cannot resolve '"+t+"'.");var e=window.document.createElement("a");return e.href=t,this.logger.log(h.LogLevel.Information,"Normalizing '"+t+"' to '"+e.href+"'."),e.href},t.prototype.resolveNegotiateUrl=function(t){var e=t.indexOf("?"),n=t.substring(0,-1===e?t.length:e);return"/"!==n[n.length-1]&&(n+="/"),n+="negotiate",n+=-1===e?"":t.substring(e)},t}()},function(t,e,n){"use strict";var r,o,i,s;n.r(e),n.d(e,"HttpTransportType",function(){return r}),n.d(e,"TransferFormat",function(){return i}),(o=r||(r={}))[o.None=0]="None",o[o.WebSockets=1]="WebSockets",o[o.ServerSentEvents=2]="ServerSentEvents",o[o.LongPolling=4]="LongPolling",(s=i||(i={}))[s.Text=1]="Text",s[s.Binary=2]="Binary"},function(t,e,n){"use strict";n.r(e),n.d(e,"LongPollingTransport",function(){return i});var o=n(19),a=n(4),c=n(8),u=n(17),l=n(12),r=function(i,s,a,c){return new(a||(a=Promise))(function(t,e){function n(t){try{o(c.next(t))}catch(t){e(t)}}function r(t){try{o(c.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,r)}o((c=c.apply(i,s||[])).next())})},p=function(n,r){var o,i,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=2&e[0]?i.return:e[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,i=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],i=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},i=function(){function t(t,e,n,r){this.httpClient=t,this.accessTokenFactory=e,this.logger=n,this.pollAbort=new o.AbortController,this.logMessageContent=r,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(t.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),t.prototype.connect=function(i,s){return r(this,void 0,void 0,function(){var e,n,r,o;return p(this,function(t){switch(t.label){case 0:if(l.Arg.isRequired(i,"url"),l.Arg.isRequired(s,"transferFormat"),l.Arg.isIn(s,u.TransferFormat,"transferFormat"),this.url=i,this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Connecting."),s===u.TransferFormat.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return e={abortSignal:this.pollAbort.signal,headers:{},timeout:1e5},s===u.TransferFormat.Binary&&(e.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return n=t.sent(),this.updateHeaderToken(e,n),r=i+"&_="+Date.now(),this.logger.log(c.LogLevel.Trace,"(LongPolling transport) polling: "+r+"."),[4,this.httpClient.get(r,e)];case 2:return 200!==(o=t.sent()).statusCode?(this.logger.log(c.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+o.statusCode+"."),this.closeError=new a.HttpError(o.statusText||"",o.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,e),[2]}})})},t.prototype.getAccessToken=function(){return r(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,null]}})})},t.prototype.updateHeaderToken=function(t,e){t.headers||(t.headers={}),e?t.headers.Authorization="Bearer "+e:t.headers.Authorization&&delete t.headers.Authorization},t.prototype.poll=function(i,s){return r(this,void 0,void 0,function(){var e,n,r,o;return p(this,function(t){switch(t.label){case 0:t.trys.push([0,,8,9]),t.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:e=t.sent(),this.updateHeaderToken(s,e),t.label=3;case 3:return t.trys.push([3,5,,6]),n=i+"&_="+Date.now(),this.logger.log(c.LogLevel.Trace,"(LongPolling transport) polling: "+n+"."),[4,this.httpClient.get(n,s)];case 4:return 204===(r=t.sent()).statusCode?(this.logger.log(c.LogLevel.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==r.statusCode?(this.logger.log(c.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+r.statusCode+"."),this.closeError=new a.HttpError(r.statusText||"",r.statusCode),this.running=!1):r.content?(this.logger.log(c.LogLevel.Trace,"(LongPolling transport) data received. "+Object(l.getDataDetail)(r.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(r.content)):this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return o=t.sent(),this.running?o instanceof a.TimeoutError?this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=o,this.running=!1):this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Poll errored after shutdown: "+o.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}})})},t.prototype.send=function(e){return r(this,void 0,void 0,function(){return p(this,function(t){return this.running?[2,Object(l.sendMessage)(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},t.prototype.stop=function(){return r(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),t.label=1;case 1:return t.trys.push([1,,5,6]),[4,this.receiving];case 2:return t.sent(),this.logger.log(c.LogLevel.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),e={headers:{}},[4,this.getAccessToken()];case 3:return n=t.sent(),this.updateHeaderToken(e,n),[4,this.httpClient.delete(this.url,e)];case 4:return t.sent(),this.logger.log(c.LogLevel.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(c.LogLevel.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}})})},t.prototype.raiseOnClose=function(){if(this.onclose){var t="(LongPolling transport) Firing onclose event.";this.closeError&&(t+=" Error: "+this.closeError),this.logger.log(c.LogLevel.Trace,t),this.onclose(this.closeError)}},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"AbortController",function(){return r});var r=function(){function t(){this.isAborted=!1,this.onabort=null}return t.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(t.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"ServerSentEventsTransport",function(){return i});var c=n(8),u=n(17),l=n(12),r=function(i,s,a,c){return new(a||(a=Promise))(function(t,e){function n(t){try{o(c.next(t))}catch(t){e(t)}}function r(t){try{o(c.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,r)}o((c=c.apply(i,s||[])).next())})},o=function(n,r){var o,i,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=2&e[0]?i.return:e[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,i=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],i=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},i=function(){function t(t,e,n,r,o){this.httpClient=t,this.accessTokenFactory=e,this.logger=n,this.logMessageContent=r,this.eventSourceConstructor=o,this.onreceive=null,this.onclose=null}return t.prototype.connect=function(s,a){return r(this,void 0,void 0,function(){var e,i=this;return o(this,function(t){switch(t.label){case 0:return l.Arg.isRequired(s,"url"),l.Arg.isRequired(a,"transferFormat"),l.Arg.isIn(a,u.TransferFormat,"transferFormat"),this.logger.log(c.LogLevel.Trace,"(SSE transport) Connecting."),this.url=s,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(e=t.sent())&&(s+=(s.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(e)),t.label=2;case 2:return[2,new Promise(function(t,n){var r=!1;if(a===u.TransferFormat.Text){var e;if("undefined"!=typeof window)e=new i.eventSourceConstructor(s,{withCredentials:!0});else{var o=i.httpClient.getCookieString(s);e=new i.eventSourceConstructor(s,{withCredentials:!0,headers:{Cookie:o}})}try{e.onmessage=function(t){if(i.onreceive)try{i.logger.log(c.LogLevel.Trace,"(SSE transport) data received. "+Object(l.getDataDetail)(t.data,i.logMessageContent)+"."),i.onreceive(t.data)}catch(t){return void i.close(t)}},e.onerror=function(t){var e=new Error(t.data||"Error occurred");r?i.close(e):n(e)},e.onopen=function(){i.logger.log(c.LogLevel.Information,"SSE connected to "+i.url),i.eventSource=e,r=!0,t()}}catch(t){return void n(t)}}else n(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})]}})})},t.prototype.send=function(e){return r(this,void 0,void 0,function(){return o(this,function(t){return this.eventSource?[2,Object(l.sendMessage)(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},t.prototype.stop=function(){return this.close(),Promise.resolve()},t.prototype.close=function(t){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(t))},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"WebSocketTransport",function(){return o});var a=n(8),c=n(17),u=n(12),r=function(i,s,a,c){return new(a||(a=Promise))(function(t,e){function n(t){try{o(c.next(t))}catch(t){e(t)}}function r(t){try{o(c.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,r)}o((c=c.apply(i,s||[])).next())})},l=function(n,r){var o,i,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=2&e[0]?i.return:e[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,i=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],i=0}finally{o=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},o=function(){function t(t,e,n,r,o){this.logger=n,this.accessTokenFactory=e,this.logMessageContent=r,this.webSocketConstructor=o,this.httpClient=t,this.onreceive=null,this.onclose=null}return t.prototype.connect=function(i,s){return r(this,void 0,void 0,function(){var e,o=this;return l(this,function(t){switch(t.label){case 0:return u.Arg.isRequired(i,"url"),u.Arg.isRequired(s,"transferFormat"),u.Arg.isIn(s,c.TransferFormat,"transferFormat"),this.logger.log(a.LogLevel.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(e=t.sent())&&(i+=(i.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(e)),t.label=2;case 2:return[2,new Promise(function(e,n){var r;i=i.replace(/^http/,"ws");var t=o.httpClient.getCookieString(i);"undefined"==typeof window&&t&&(r=new o.webSocketConstructor(i,void 0,{headers:{Cookie:""+t}})),r||(r=new o.webSocketConstructor(i)),s===c.TransferFormat.Binary&&(r.binaryType="arraybuffer"),r.onopen=function(t){o.logger.log(a.LogLevel.Information,"WebSocket connected to "+i+"."),o.webSocket=r,e()},r.onerror=function(t){var e=null;"undefined"!=typeof ErrorEvent&&t instanceof ErrorEvent&&(e=t.error),n(e)},r.onmessage=function(t){o.logger.log(a.LogLevel.Trace,"(WebSockets transport) data received. "+Object(u.getDataDetail)(t.data,o.logMessageContent)+"."),o.onreceive&&o.onreceive(t.data)},r.onclose=function(t){return o.close(t)}})]}})})},t.prototype.send=function(t){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(a.LogLevel.Trace,"(WebSockets transport) sending data. "+Object(u.getDataDetail)(t,this.logMessageContent)+"."),this.webSocket.send(t),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},t.prototype.stop=function(){return this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0,this.close(void 0)),Promise.resolve()},t.prototype.close=function(t){this.logger.log(a.LogLevel.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!t||!1!==t.wasClean&&1e3===t.code?this.onclose():this.onclose(new Error("WebSocket closed with status code: "+t.code+" ("+t.reason+").")))},t}()},function(t,e,n){"use strict";n.r(e),n.d(e,"JsonHubProtocol",function(){return o});var a=n(14),c=n(8),r=n(17),u=n(13),l=n(11),o=function(){function t(){this.name="json",this.version=1,this.transferFormat=r.TransferFormat.Text}return t.prototype.parseMessages=function(t,e){if("string"!=typeof t)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!t)return[];null===e&&(e=u.NullLogger.instance);for(var n=[],r=0,o=l.TextMessageFormat.parse(t);r<o.length;r++){var i=o[r],s=JSON.parse(i);if("number"!=typeof s.type)throw new Error("Invalid payload.");switch(s.type){case a.MessageType.Invocation:this.isInvocationMessage(s);break;case a.MessageType.StreamItem:this.isStreamItemMessage(s);break;case a.MessageType.Completion:this.isCompletionMessage(s);break;case a.MessageType.Ping:case a.MessageType.Close:break;default:e.log(c.LogLevel.Information,"Unknown message type '"+s.type+"' ignored.");continue}n.push(s)}return n},t.prototype.writeMessage=function(t){return l.TextMessageFormat.write(JSON.stringify(t))},t.prototype.isInvocationMessage=function(t){this.assertNotEmptyString(t.target,"Invalid payload for Invocation message."),void 0!==t.invocationId&&this.assertNotEmptyString(t.invocationId,"Invalid payload for Invocation message.")},t.prototype.isStreamItemMessage=function(t){if(this.assertNotEmptyString(t.invocationId,"Invalid payload for StreamItem message."),void 0===t.item)throw new Error("Invalid payload for StreamItem message.")},t.prototype.isCompletionMessage=function(t){if(t.result&&t.error)throw new Error("Invalid payload for Completion message.");!t.result&&t.error&&this.assertNotEmptyString(t.error,"Invalid payload for Completion message."),this.assertNotEmptyString(t.invocationId,"Invalid payload for Completion message.")},t.prototype.assertNotEmptyString=function(t,e){if("string"!=typeof t||""===t)throw new Error(e)},t}()}])});