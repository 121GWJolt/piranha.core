Vue.component("sitemap-item",{props:["item"],methods:{toggleItem:function(i){i.isExpanded=!i.isExpanded}},template:"<li class='dd-item' :class='{ expanded: item.isExpanded || item.items.length === 0 }' :data-id='item.id'>  <div class='sitemap-item'>    <div class='handle dd-handle'><i class='fas fa-ellipsis-v'></i></div>    <div class='link'>      <span class='actions'>        <a v-if='item.items.length > 0 && item.isExpanded' v-on:click.prevent='toggleItem(item)' class='expand' href='#'><i class='fas fa-minus'></i></a>        <a v-if='item.items.length > 0 && !item.isExpanded' v-on:click.prevent='toggleItem(item)' class='expand' href='#'><i class='fas fa-plus'></i></a>      </span>      <a :href='piranha.baseUrl + item.editUrl + item.id'>        {{ item.title }}        <span v-if='item.status' class='badge badge-info'>{{ item.status }}</span>      </a>    </div>    <div class='type d-none d-md-block'>{{ item.typeName }}</div>    <div class='date d-none d-md-block'>{{ item.published }}</div>    <div class='actions'>      <a href='#' v-on:click='piranha.pagelist.add(item.id, true)'><i class='fas fa-angle-down'></i></a>      <a href='#' v-on:click='piranha.pagelist.add(item.id, false)'><i class='fas fa-angle-right'></i></a>      <a v-if='item.items.length === 0' v-on:click.prevent='piranha.pagelist.remove(item.id)' class='danger' href='#'><i class='fas fa-trash'></i></a>    </div>  </div>  <ol v-if='item.items.length > 0' class='dd-list'>    <sitemap-item v-for='child in item.items' v-bind:key='child.id' v-bind:item='child'>    </sitemap-item>  </ol></li>"}),piranha.pagelist=new Vue({el:"#pagelist",data:{loading:!0,updateBindings:!1,items:[],sites:[],pageTypes:[],addPageId:null,addAfter:!0},methods:{load:function(){fetch(piranha.baseUrl+"manager/api/page/list").then(function(i){return i.json()}).then(function(i){piranha.pagelist.sites=i.sites,piranha.pagelist.pageTypes=i.pageTypes,piranha.pagelist.updateBindings=!0}).catch(function(i){console.log("error:",i)})},remove:function(i){var e=this;fetch(piranha.baseUrl+"manager/api/page/delete/"+i).then(function(i){return i.json()}).then(function(i){piranha.notifications.push(i),e.load()}).catch(function(i){console.log("error:",i)})},bind:function(){var i=this;$(".sitemap-container").each(function(e,a){$(a).nestable({maxDepth:100,group:e,callback:function(e,a){fetch(piranha.baseUrl+"manager/api/page/move",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:$(a).attr("data-id"),items:$(e).nestable("serialize")})}).then(function(i){return i.json()}).then(function(e){piranha.notifications.push(e.status),"success"===e.status.type&&($(".sitemap-container").nestable("destroy"),i.sites=[],Vue.nextTick(function(){i.sites=e.sites,Vue.nextTick(function(){i.bind()})}))}).catch(function(i){console.log("error:",i)})}})})},add:function(i,e){this.addPageId=i,this.addAfter=e,$("#pageAddModal").modal("show")}},created:function(){},updated:function(){this.updateBindings&&(this.bind(),this.updateBindings=!1),this.loading=!1}});